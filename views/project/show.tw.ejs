<div class="header-bar flex align-items-center justify-content-between">
    <h4 class="text-grey-lightest inline"><%= project.title %></h4>
    <a href="/project/<%= project.id %>/members">
    <div class="flex align-items-center">
        <% for(let i = 0; i < project.members.length; i++) { %>
            <img width="50" height="50" style="object-fit: cover; margin-left: -20px; z-index:<%= 2-i %>" class="rounded-full" src="/<%=project.members[i].user.picture%>"/>
        <% } %>
        <% if (project.moreMembers > 0) { %>
                <h4 class="mx-1 text-white">+<%= project.moreMembers %></h4>
        <% } %>
  </div>
</a>
    <button type="button" id="invite-modal-btn" class="inline-block align-middle text-center select-none border font-normal whitespace-no-wrap py-2 px-4 rounded text-base leading-normal no-underline text-teal-lightest bg-teal hover:bg-teal-light" data-toggle="modal" data-target="#inviteUsers">
        + Invite
    </button>
    <div class="modal opacity-0" id="inviteUsers" tabindex="-1" role="dialog" aria-labelledby="inviteUsersModal" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="inviteUsersModal">Invite Users</h5>
              <button type="button" class="absolute pin-t pin-b pin-r px-4 py-3" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <h6>Friends</h6>
              <div class="relative flex items-stretch w-full mt-3">
                <input type="text" name="q" class="block appearance-none w-full py-1 px-2 mb-1 text-base leading-normal bg-white text-grey-darker border border-grey rounded bg-grey-lightest border-0 text-sm" placeholder="Search for user..."
                    aria-label="Search" aria-describedby="basic-addon2">
                <div class="input-group-append">
                    <button class="inline-block align-middle text-center select-none border font-normal whitespace-no-wrap py-2 px-4 rounded text-base leading-normal no-underline text-blue-lightest bg-blue hover:bg-blue-light" type="submit">
                        <i class="fas fa-search fa-sm"></i>
                    </button>
                </div>
            </div>
              <div id="inviteFriendsList">
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="inline-block align-middle text-center select-none border font-normal whitespace-no-wrap py-2 px-4 rounded text-base leading-normal no-underline text-grey-lightest bg-grey hover:bg-grey-light" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
</div>
<script>
  $('#invite-modal-btn').on('click', ()=>{
    let list = $('#inviteFriendsList');
    if(list.children().length > 0) return;
    $.ajax({
      url:'/user/friends',
      method:'GET',
      contentType:'application/json',
      success:(data)=>{
        for(friend of data){
          list.append(`
          <a href="/user/`+friend.id+`" class="text-reset text-decoration-none">
              <div class="flex flex-wrap p-3 align-items-center">
                  <div class="w-1/5">
                      <img src="/`+friend.picture+`" width="50" height="50" style="object-fit:cover" class="rounded-full border"/>
                  </div>
                  <div class="w-1/2">
                      <h5>`+friend.username+`</h5>
                      <h6>`+friend.email+`</h6>
                  </div>
                  <div class="w-1/3">
                      <button data-id="`+friend.id+`" class="inline-block align-middle text-center select-none border font-normal whitespace-no-wrap py-2 px-4 rounded text-base leading-normal no-underline text-blue-lightest bg-blue hover:bg-blue-light float-right">invite</button>
                  </div>
              </div>
          </a>
          `);
          }
        }
      });
  });
</script>
